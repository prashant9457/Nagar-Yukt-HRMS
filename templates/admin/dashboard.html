<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard ‚Ä¢ HRMS</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Admin Dashboard CSS -->
    <link rel="stylesheet" href="/static/css/adminDashboard.css">
</head>

<body>

<div class="dashboard-container">

    <!-- ================= ADMIN PROFILE ================= -->
    <div class="profile-card">
        <h2>Admin Profile</h2>
        <p><b>Name:</b> {{ user.name }}</p>
        <p><b>Role:</b> Recruitment Admin</p>

        <a href="/auth/logout" class="logout-btn">Logout</a>
    </div>

    <!-- ================= CREATE JOB ================= -->
    <div class="form-card">
        <h2>Create & Publish Job</h2>

        <div class="form-grid">
            <input id="title" placeholder="Job Title">

            <!-- Department Dropdown -->
            <select id="department">
                <option value="">Select Department</option>
                <option>Human Resources</option>
                <option>Engineering</option>
                <option>Finance</option>
                <option>Urban Planning</option>
                <option>IT Services</option>
                <option>Public Health</option>
            </select>

            <!-- Location Dropdown -->
            <select id="location">
                <option value="">Select Location</option>
                <option>New Delhi HQ</option>
                <option>North Zone Office</option>
                <option>South Zone Office</option>
                <option>East Zone Office</option>
                <option>West Zone Office</option>
            </select>

            <input id="vacancies" type="number" placeholder="Vacancies">
        </div>

        <button class="primary-btn" onclick="createJob()">Publish Job</button>
        <p id="msg" class="message"></p>
    </div>

    <!-- ================= PUBLISHED JOBS ================= -->
    <section class="jobs-section">
        <h2>Published Jobs</h2>

        <div class="jobs-grid">
            {% for job in jobs %}
            <div class="job-card">

                <!-- Map Placeholder -->
                <div class="job-map">
                    üìç {{ job.location if job.location else "MCD Office" }}
                </div>

                <h4>{{ job.title }}</h4>
                <p class="job-dept">{{ job.department }}</p>

                <a href="/admin/job/{{ job.id }}/applications" class="view-btn">
                    View Applicants
                </a>
            </div>
            {% endfor %}
        </div>
    </section>

</div>

<script src="/static/js/app.js"></script>

<script>
async function createJob() {
    const data = {
        title: document.getElementById("title").value,
        department: document.getElementById("department").value,
        location: document.getElementById("location").value,
        vacancies: parseInt(document.getElementById("vacancies").value),
        created_by: {{ user.user_id }}
    };

    const res = await postData("/admin/create-job", data);
    document.getElementById("msg").innerText = res.message || res.error;
    document.getElementById("msg").className =
        res.error ? "message error" : "message success";
}
</script>

</body>
</html>
